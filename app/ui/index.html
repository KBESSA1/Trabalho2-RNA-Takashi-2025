<!doctype html>
<meta charset="utf-8"/>
<title>FACOM RAG Bot</title>
<style>
  body{font-family:system-ui,Segoe UI,Arial;margin:24px;max-width:920px}
  textarea{width:100%;min-height:90px}
  .msg{white-space:pre-wrap;border:1px solid #ddd;padding:12px;border-radius:8px;margin-top:12px}
  .small{color:#666;font-size:0.9em}
</style>
<h1>ðŸ¤– FACOM RAG Bot</h1>
<p class="small">Responde apenas com base no REGULAMENTO.pdf e cita os chunks.</p>
<textarea id="q" placeholder="Digite sua pergunta..."></textarea>
<br><button id="go">Perguntar</button>
<pre id="out" class="msg"></pre>
<script>
async function ask(){
  const q = document.getElementById('q').value.trim();
  if(!q){ return; }
  const res = await fetch('/ask',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({question:q})});
  const js = await res.json();
  const cites = (js.citations||[]).map(c=>`- ${c}`).join('\n');
  const got  = (js.retrieved||[]).map(r=>`â€¢ ${r.source} | ${r.ref} | chunk ${r.chunk_id} | sim=${r.sim}`).join('\n');
  document.getElementById('out').textContent =
    `Pergunta:\n${q}\n\nResposta:\n${js.answer}\n\nCitaÃ§Ãµes:\n${cites}\n\nTop-K:\n${got}`;
}
document.getElementById('go').onclick = ask;
</script>
